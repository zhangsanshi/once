!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.Once=n():t.Once=n()}(this,function(){return function(t){function n(i){if(e[i])return e[i].exports;var o=e[i]={exports:{},id:i,loaded:!1};return t[i].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}var e={};return n.m=t,n.c=e,n.p="",n(0)}([function(t,n,e){"use strict";function i(t,n,e){var i=o[t];return e=e||{},i?e.force&&s.isFunction(n)&&(i.machine=n):s.isFunction(n)&&(i=o[t]=new r(n,e)),i}var o=e(1),r=e(3),s=e(2);i.one=function(t){var n=i.apply(i,arguments);return n&&!n.one&&(n.$afterDone=function(){i.remove(t)},n.one=!0),n},i.remove=function(t){delete o[t]},t.exports=i},function(t,n){"use strict";t.exports={}},function(t,n,e){"use strict";var i=e(1);t.exports={toString:i.toString,isFunction:function(t){return t&&"[object Function]"===this.toString.call(t)},isPromise:function(t){return t&&this.isFunction(t.then)}}},function(t,n,e){"use strict";function i(t,n){n=n||{},this.state="pending",this.machine=t,this.doneTimes=0,this.afterDoing=n.afterDoing,this.afterDone=n.afterDone}var o=e(2),r={pending:!0,doing:!0,done:!0};i.prototype={getState:function(){return this.state},updateState:function(t){return r[t]&&(this.state=t),this},isDoing:function(){return"doing"===this.state},run:function(){function t(){e.done()}var n=null,e=this;if(!this.isDoing()){this.updateState("doing");try{n=this.machine()}catch(i){throw this.updateState("pending"),new Error(i)}o.isFunction(this.afterDoing)&&this.afterDoing(),o.isPromise(n)&&(n=n.then(t,t))}return n},done:function(){return this.isDoing()&&(o.isFunction(this.afterDone)&&this.afterDone(),this.one&&o.isFunction(this.$afterDone)&&this.$afterDone(),this.updateState("done"),this.doneTimes++),this}},t.exports=i}])});